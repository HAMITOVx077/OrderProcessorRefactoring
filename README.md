# Рефакторинг Order Processor

## Описание проекта
Проект демонстрирует процесс тестирования и рефакторинга legacy кода. Класс `OrderProcessor` из гипотетической системы интернет-магазина был улучшен с сохранением и улучшением исходного поведения.

## Ключевые улучшения

### Проблемы исходного кода
- Жесткая связность в одном методе ProcessOrder
- Отсутствие валидации зависимостей в конструкторе
- Неочевидная логика отправки email (магическое число 100)
- Некорректная обработка исключений EmailService
- Низкая читаемость и поддерживаемость кода

### Результаты рефакторинга
- Разделение ответственности на отдельные методы
- Валидация зависимостей в конструкторе
- Замена магического числа на именованную константу
- Исправление логики обработки исключений EmailService
- Повышена читаемость и тестируемость кода

## Обнаруженный и исправленный дефект
В исходной реализации при исключении в EmailService метод возвращал `false`, даже если заказ был успешно сохранен в БД. Это создавало проблему целостности данных. После рефакторинга система корректно отмечает заказ как обработанный, даже при ошибках отправки email.

## Стратегия тестирования
- 10 комплексных модульных тестов
- Покрытие основных и граничных сценариев
- Изоляция зависимостей через Moq
- Тестирование обработки исключений
- Следование паттерну AAA

## Технологии
- C# .NET
- NUnit
- Moq
- Visual Studio

## Результаты тестирования
После рефакторинга все 10 тестов успешно выполняются, подтверждая корректность работы системы.

## Структура проекта
1)OrderProcessing.Core
-OrderProcessor.cs (рефакторнутая версия)
-IDatabase.cs
-IEmailService.cs
-Order.cs
2)OrderProcessing.Tests
-OrderProcessorTests.cs (10 тестов)

## Как запустить
1. Клонировать репозиторий
2. Восстановить NuGet пакеты
3. Запустить тесты через Test Explorer

## Примеры тестовых сценариев
- Обработка заказа с null значением
- Заказы с нулевой и отрицательной суммой
- Успешная обработка с отправкой email
- Обработка исключений базы данных
- Обработка исключений email службы
